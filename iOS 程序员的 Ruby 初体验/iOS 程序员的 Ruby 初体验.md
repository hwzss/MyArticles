#iOS ç¨‹åºå‘˜çš„ Ruby åˆä½“éªŒ

![æµ·è´¼ç‹ææ¶ä¸–ä»£](https://raw.githubusercontent.com/hwzss/MyArticles/master/iOS%20%E7%A8%8B%E5%BA%8F%E5%91%98%E7%9A%84%20Ruby%20%E5%88%9D%E4%BD%93%E9%AA%8C/%E6%9E%81%E6%81%B6%E4%B8%96%E4%BB%A31.png)


> åœ¨æŠ€æœ¯æµªæ½®ä¸æ–­æ›´æ–°å‘å±•çš„æ—¶ä»£ä¸‹ï¼Œèº«ä¸ºç¨‹åºå‘˜çš„æˆ‘ä»¬ä¸æ–­çš„åœ¨å­¦ä¹ æ–°æŠ€æœ¯ï¼Œä¸æ–­çš„æ›´æ–°è‡ªå·±çš„æŠ€èƒ½ï¼Œä¸æ–­çš„å’Œä¼™ä¼´ä»¬ä¸€èµ·æˆé•¿ï¼Œæ¢¦æƒ³ç€æœ‰å¤©èƒ½èˆªè¡Œåˆ°æŠ€æœ¯çš„é¡¶ç«¯ã€‚å°±åƒæµ·è´¼ç‹é‡Œæœ€æ¶ä¸–ä»£ä»¬ä¸€æ ·ï¼Œåªæœ‰ä¸æ–­çš„æŒ‘æˆ˜ï¼Œä¸æ–­çš„æˆé•¿æŠ±å›¢æ‰“å€’ BOSSï¼Œæ‰å¯èƒ½åˆ°è¾¾ç»ˆç‚¹å¾—åˆ° ONE PIECE ã€‚

###å‰è¨€
ä¸€å¼€å§‹è‡ªå·±å»å­¦ä¹  [Ruby](https://zh.wikipedia.org/wiki/Ruby) åªæ˜¯æƒ³äº†è§£ Podfile é‡Œå†™çš„ä¸œè¥¿åˆ°åº•æ˜¯ä»€ä¹ˆï¼Œåˆ°åé¢å¯¹ Cocoapod å’Œ fastlane æºç å’ŒåŸç†çš„å¥½å¥‡ï¼Œå†åˆ°æƒ³é€šè¿‡å­¦ä¹ åˆ°çš„ä¸œè¥¿æ”¹å–„è‡ªå·±çš„å·¥ä½œæµã€‚

æœ¬ç¯‡æ–‡ç« è®°å½•äº†è‡ªå·±ä»å°ç™½åˆ° Ruby ç®€å•å…¥é—¨çš„æ—…ç¨‹ã€‚

###Ruby å­¦ä¹ 

åšä¸ºä¸€ä¸ªRubyå°ç™½ï¼Œæ²¡äººæ•™ï¼Œå•¥éƒ½ä¸æ‡‚è¯¥å¦‚ä½•å»å­¦ä¹ è¿™æ ·ä¸€é—¨æ–°çš„è¯­è¨€ã€‚
æ²¡æœ‰åˆ«çš„ï¼Œåªèƒ½é è‡ªå·±ç¨‹åºå‘˜çš„å¤§è„‘å’ŒæŠ˜è…¾ã€‚

å¯¹äºæ–°çš„ç¼–ç¨‹è¯­è¨€æˆ‘éœ€è¦å»äº†è§£ä»–çš„è¯­æ³•ï¼Œæ‰€ä»¥æ‰¾åˆ°è¿™å‡ ä¸ªç½‘å€ï¼š

1. [rubyåŸºç¡€æ•™ç¨‹ï¼ˆä¸­æ–‡ç¬¬å››ç‰ˆï¼‰](https://www.kancloud.cn/imxieke/ruby-base)
2. [Ruby | èœé¸Ÿæ•™ç¨‹](http://www.runoob.com/ruby/ruby-tutorial.html)
3. [Ruby Chinaç¤¾åŒº](https://ruby-china.org/)

å¯¹äº Ruby è¯­æ³•åˆšæ¥è§¦æœ‰å‡ ä¸ªåœ°æ–¹æœ‰è¾ƒæ·±çš„æ˜ åƒï¼š

1. å®Œå…¨é¢å‘å¯¹è±¡ï¼šä»»ä½•ä¸œè¥¿éƒ½æ˜¯å¯¹è±¡ï¼Œæ²¡æœ‰åŸºç¡€ç±»å‹ã€‚å¹³æ—¶æˆ‘ä»¬ä½¿ç”¨çš„1ï¼Œ2ï¼Œ3ï¼Œ4ï¼Œ5ï¼Œ6åœ¨Rubyéƒ½æ˜¯ â€˜Fixnumâ€™ ç±»çš„å®ä¾‹å¯¹è±¡ï¼Œæœ‰ç€å±äºè‡ªå·±çš„æ–¹æ³•ã€‚
    
    ```Ruby
    1.to_s   // å°† 1 è½¬ä¸ºå­—ç¬¦ä¸²
    ```
2. æ–¹æ³•è°ƒç”¨å¯ä»¥çœç•¥æ‹¬å·ï¼Œæ¯”å¦‚:
    
    ```
        puts("hello, world")
    ```
    ä¹Ÿå¯ä»¥è¿™æ ·
    
    ```
        puts "hello, world"
    ```
    
3. ä»£ç å—ä¹‹é—´ä¸æ˜¯ç”¨{}æ¥è¡¨ç¤ºä»£ç å—çš„èŒƒå›´ è€Œæ˜¯ end æ¥è¡¨ç¤ºå—çš„ç»“å°¾ã€‚æ¯”å¦‚å®šä¹‰ä¸€ä¸ªæ–¹æ³• OC çš„åšæ³•æ˜¯ï¼š
    
    ```
     - (void) method {
        è¿™é‡Œæ˜¯æ–¹æ³•å®ç°ä»£ç 
     }
    ```
    è€Œåœ¨ Ruby é‡Œï¼š
    
    ```
    def method 
        è¿™é‡Œæ˜¯æ–¹æ³•å®ç°ä»£ç 
    end
    ```
    
4. å¯ä»¥ç”¨æ¢è¡Œæ›¿æ¢ â€œ ; â€ï¼Œå³ä»£ç ä¸­å¯ä»¥çœç•¥ â€œ ; â€ã€‚

    åœ¨ OC ä¸­ï¼š
    
    ```Objective-C
     - (void) method {
        ç¬¬ä¸€è¡Œä»£ç ;
        ç¬¬äºŒè¡Œä»£ç ;
     }
    ```
    Rubyä¸­ï¼š
    
    ```Ruby
    def method 
        ç¬¬ä¸€è¡Œä»£ç 
        ç¬¬äºŒè¡Œä»£ç 
    end
    ```
    
5. æ¯è¡Œä»£ç éƒ½æœ‰è¿”å›å€¼ã€‚

   æˆ‘ä»¬åœ¨ irb ä¸­è¾“å…¥ä¸‹é¢ä»£ç ï¼ˆirbå†…ç½®åœ¨shellçš„rubyè§£é‡Šå™¨ï¼‰ã€‚
    
    ```ruby
    irb(main):001:0> puts 'hello, world'
    hello, world
    => nil
    ```
    puts 'hello, world'æ„ä¸ºæ‰“å°'hello, world'å­—ç¬¦ä¸²ã€‚æ‰€ä»¥æˆ‘ä»¬å¾—åˆ°çš„ç¬¬ä¸€ä¸ªè¾“å‡ºä¸ºæ­£å¸¸æ–¹æ³•æ‰§è¡Œçš„æ•ˆæœï¼Œæ‰“å°å‡º'hello, world'å­—ç¬¦ä¸²ã€‚è€Œç¬¬äºŒè¡Œ
    
    ```
    => nil
    ```
    åˆ™æ˜¯æ„å‘³ç€è¯¥è¡Œä»£ç çš„æ”¾å›å€¼ä¸ºnilã€‚
    
    å¦‚æœæˆ‘ä»¬çš„ä»£ç æ˜¯ç»™ä¸€ä¸ªå˜é‡ï¼Œé‚£è¿™è¡Œä»£ç çš„è¿”å›å€¼å°†æ˜¯å˜é‡çš„å€¼ï¼Œå¦‚ä¸‹ï¼š
    
    ```
    irb(main):002:0> a = 1
    => 1
    ```
6. ä¸€ä¸ªæœ‰è¿”å›å€¼çš„æ–¹æ³•ä¸­å¦‚æœæ²¡æœ‰returnï¼Œåˆ™æœ€åä¸€è¡Œä»£ç çš„è¿”å›å€¼å°±æ˜¯è¯¥æ–¹æ³•çš„è¿”å›å€¼ã€‚å¦‚ï¼š
    
    ```
    def method 
        a = 1
    end
    ```
    
    è¯¥æ–¹æ³•çš„è¿”å›å€¼ä¸º 1 ã€‚

###å®è·µ

å­¦ä¹ ä»»ä½•ç¼–ç¨‹è¯­è¨€æœ€å¿«çš„æ–¹å¼å°±æ˜¯ä¸Šæ‰‹æ•²ã€‚
åœ¨äº†è§£Rubyå¤§è‡´çš„è¯­æ³•åï¼Œä¾¿éœ€è¦å¼€å§‹å¯»æ‰¾å·¥å…·æ¥è¿›è¡Œ Coding å®æˆ˜ã€‚æœ€ååŸºäºå·¥å…·çš„å­¦ä¹ æ—¶é—´æˆæœ¬å…ˆæŒ‘é€‰äº† irb å’Œ Sublime Text

#### irb

å…¨å â€œinteractive rubyâ€ ï¼Œä¸€ä¸ªå‘½ä»¤è¡Œå·¥å…·ï¼Œä¹Ÿå¯ä»¥çœ‹ä½œæ˜¯Rubyçš„è§£é‡Šå™¨ã€‚
MacOsä¸‹ç³»ç»Ÿè‡ªå¸¦ï¼Œæ‰“å¼€ç»ˆç«¯è¾“å…¥ï¼š

```Shell
irb
```

å³å¯å¯åŠ¨ã€‚å¯åŠ¨åå°±å¯ä»¥è¾“å…¥Rubyä»£ç çš„ï¼Œæ³¨æ„æ¯è¾“å…¥ä¸€è¡Œä»£ç ï¼Œirbéƒ½ä¼šç»™ä½ è¿”å›è¯¥è¡Œä»£ç çš„è¿”å›å€¼ï¼Œå¦‚åˆšåˆšå‡ºç¤ºçš„ä»£ç log

```Ruby
irb(main):001:0> puts 'hello, world'
hello, world
=> nil
```

####Sublime Text

Sublime Text æ˜¯ä¸€å¥—å¾ˆå¥½è·¨å¹³å°çš„æ–‡å­—ç·¨è¼¯å™¨ï¼Œå¦‚æœæƒ³è¦ç¼–å†™å¾ˆé•¿çš„ Ruby ä»£ç åœ¨ irb ä¸æ˜¯å¾ˆæ–¹ä¾¿ï¼Œæ‰€ä»¥é€‰æ‹©äº†å®ƒã€‚ï¼ˆ [Sublime Text ç»´åŸºç™¾ç§‘](https://zh.wikipedia.org/wiki/Sublime_Text) ï¼‰


###é˜…è¯»æºç 

é€šè¿‡ä¸€æ®µæ—¶é—´çš„å®è·µç†è§£ï¼Œå¤§è‡´å¯¹ Ruby æœ‰åˆæ­¥çš„è®¤è¯†ï¼Œå¯ä»¥å°è¯•é˜…è¯» [fastlane](https://fastlane.tools/), [cocoapod](https://cocoapods.org/about) æºç æ¥å¯¹å®ƒä»¬è¿›è¡Œç†è§£äº† ( [fastlaneæºç ](https://github.com/fastlane/fastlane)ï¼Œ[CocoaPodsæºç ](https://github.com/CocoaPods/CocoaPods) )ã€‚

é€šè¿‡æºç çš„é˜…è¯»å¯¹ä»–ä»¬å¤§è‡´æ€»ç»“ä¸ºï¼šé€šè¿‡ Ruby æ¥è°ƒç”¨ç»ˆç«¯å‘½ä»¤ã€‚

è¿™é‡Œå°¤å…¶æ˜¯fastlaneï¼Œè¯» fastlane çš„å¾ˆå¤šçš„å·¥å…·é›† ( [actions](https://docs.fastlane.tools/actions/) ) çš„æºç ä½ ä¼šå‘ç°é‡Œé¢åŸºæœ¬æ˜¯æä¾›äº†å„ç§ shell å‘½ä»¤çš„åˆé›†ã€‚å¦‚ action : [pod_lib_lint](https://docs.fastlane.tools/actions/pod_lib_lint/#pod_lib_lint) çš„ [æºç ](https://github.com/fastlane/fastlane/blob/master/fastlane/lib/fastlane/actions/pod_lib_lint.rb)ä¸­å¯çœ‹åˆ°:

```
command << "pod lib lint"

if params[:verbose]
command << "--verbose"
end

if params[:sources]
sources = params[:sources].join(",")
command << "--sources='#{sources}'"
end

if params[:allow_warnings]
command << "--allow-warnings"
end
``` 

æºç ä¸­å¯ä»¥çœ‹åˆ°é‡Œé¢æä¾›äº†æˆ‘ä»¬å¹³æ—¶åœ¨ Shell ä¸­ä¸»åŠ¨è¾“å…¥çš„ä¸€äº›å‘½ä»¤ã€‚

æ‰€ä»¥å¦‚æœä½ æƒ³åšä¸€ä¸ª fastlane çš„ actionï¼Œå…¶å®å¾ˆç®€å•ï¼Œé‡Œé¢å¤šæ•°éƒ½æ˜¯å¾€command æ•°ç»„ä¸­æ’å…¥å‘½ä»¤ï¼Œä½ åªè¦æ³¨æ„éµä» fastlane å¯¹ä½ ä»¬çš„è¦æ±‚æ ¼å¼è¿›è¡Œæäº¤ä½ çš„ action ä»£ç å®¡æ ¸å°±è¡Œã€‚

å¦å¤–æˆ‘ä»¬åœ¨ä½¿ç”¨ fastlane è¿›è¡Œæ‰“åŒ…çš„æ—¶å€™ï¼Œèƒ½æ¸…æ¥šçš„çœ‹åˆ°å…¶ç­”åº”å‡ºæ‰€ä½¿ç”¨çš„ xcodebuild çš„å‘½ä»¤ã€‚

å…¶å®è¿™äº›ä¹Ÿå¯ä»¥é€šè¿‡ Shell è„šæœ¬æ¥å®ç°ï¼Œé‚£ä¸ºä»€ä¹ˆ fastlaneï¼ŒCocoapods æ˜¯ç”¨ Ruby æ¥å®ç°çš„ï¼Œç¬”è€…çŒœæƒ³å¯èƒ½æ˜¯å› ä¸º fastlaneï¼ŒCocoapods æœ¬èº«å°±æ˜¯åŸºäº Ruby å¼€å‘ä¸­çš„å·¥å…· rake å’Œ bundle æ€æƒ³è€Œå¼€å‘å‡ºæ¥çš„å§ã€‚

###ç»§ç»­å®è·µ

ç¨‹åºå‘˜å°±æ˜¯è¦æŠ˜è…¾è‡ªå·±ï¼Œæ—¢ç„¶å¤§è‡´åŸç†æ˜¯é€šè¿‡ Ruby æ‰§è¡Œ Shell å‘½ä»¤ï¼Œé‚£ä»–ä»¬èƒ½å†™å¾ˆå¤šå·¥å…·æ¥å¸®åŠ©ç¨‹åºå‘˜å¼€å‘ï¼Œæˆ‘è‡ªå·±èƒ½å†™ä¸€ä¸ªå—ï¼Ÿ ä¸æ±‚å†™å‡ºæ¥çš„é«˜å¤§ä¸Šï¼Œä½†æ±‚å­¦åˆ°çš„ä¸œè¥¿èƒ½å®è·µåº”ç”¨ï¼Œå†™å‡ºæ¥çš„ä¸œè¥¿èƒ½æ–¹ä¾¿è‡ªå·±ã€‚

äºæ˜¯å°±æœ‰äº†è¿™ä¸ªé¡¹ç›® [pod_updater](https://github.com/hwzss/pod_updater)ï¼Œè¿™ä¸ªé¡¹ç›®æ„åœ¨å¸®åŠ©è‡ªå·±æ‘†è„±æ¯æ¬¡æäº¤è‡ªå·±çš„ç§æœ‰ pod åº“æ—¶ï¼Œæ€»æ˜¯è¦åœ¨ç»ˆç«¯è¾“å…¥ä¸€å † git å‘½ä»¤ç„¶ååœ¨ push åˆ° podspec ä»“åº“ç­‰ä¸€ç³»ç¹ççš„æ“ä½œã€‚

###å¼€å§‹å®è·µ

é¦–å…ˆæ„Ÿè§‰ irb ä¸å¤Ÿç”¨äº†ï¼Œä¸èƒ½å¯¹ä»£ç è¿›è¡Œè°ƒè¯•ï¼Œè€Œ Sublime Text åªæ˜¯ä¸ªç¼–è¾‘å™¨ï¼Œäºæ˜¯åˆæ‰¾åˆ°äº† RubyMine ã€‚

RubyMine æ˜¯ä¸€ä¸ªç”¨äº Ruby å¼€å‘çš„ IDEï¼Œå¯è§[èµ„æ–™](https://baike.baidu.com/item/RubyMine)ã€‚

1. æœ‰äº† IDE è¿˜ä¸å¤Ÿï¼Œæœ‰æ—¶æˆ‘ä»¬éœ€è¦ä½¿ç”¨äº›æˆç†Ÿçš„ä¸‰æ–¹åº“ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦äº†è§£è¿™äº› Gemï¼Œbundleï¼ŒGemfile.

    Gemï¼šRuby æ‡‰ç”¨ç¨‹å¼æˆ–ç¨‹å¼åº«ã€‚å¯ä»¥ç†è§£ä¸ºFrameworkã€‚
    bundleï¼š æ˜¯ç®¡ç†ã€è§£æ±º gem ä¹‹é–“ç›¸ä¾æ€§çš„å·¥å…·ï¼Œå®ƒæœƒæ ¹æ“š Gemfile è£¡é ­çš„è¨­å®šè‡ªå‹•ä¸‹è¼‰å’Œå®‰è£ gem ï¼Œè€Œä¸”å¹«ä½ è§£æ±ºç›¸ä¾å•é¡Œã€‚å¯ä»¥ç†è§£ä»–ä¸ºiOSå¼€å‘ä¸­çš„Cocoapodã€‚
    Gemfileï¼šç†è§£ä¸ºpodfileå³å¯ï¼Œç”¨äºæè¿°ç¨‹åºçš„ç›¸å…³åº“å®‰è£…ä¸ä¾èµ–å…³ç³»ã€‚
    [æ›´å¤šèµ„æ–™](http://yulin-learn-web-dev.logdown.com/posts/246089-brief-notes-of-rubygem-gem-rvm-gemfile-bundler)

2. Ruby æ‰§è¡Œshell å‘½ä»¤
    Rubyæ‰§è¡Œ shell å‘½ä»¤æ–¹å¼æœ‰å¾ˆå¤šç§ï¼Œå¯è§[èµ„æ–™]() ï¼Œè€Œæˆ‘é€‰æ‹©æ˜¯çš„ IO.popen æ–¹æ³•ã€‚
    
    ```
    $ irb
    IO.popen("date") { |f| puts f.gets }
    Wed Jul  4 22:02:31 CST 2012
    => nil
    ```
    
3. æ¥ç€å°±æ˜¯å„ç§èµ„æ–™æŸ¥æ‰¾å’ŒæŠ˜è…¾ï¼Œæœ€åæ¨¡ä»¿ fastlane å’Œ CocoaPods å°†è‡ªå·±çš„å·¥å…·åšæˆ gem çš„å½¢å¼ï¼Œäºæ˜¯æˆ‘çš„ç¬¬ä¸€ä¸ª RubyGem [pod_updater](https://rubygems.org/gems/pod_updater) è¯ç”Ÿäº†ï¼Œä½¿ç”¨æ•ˆæœå¦‚ä¸‹ï¼š
    
    ![è¿™æ˜¯pod_updater ç»ˆç«¯ä½¿ç”¨.gif](https://raw.githubusercontent.com/hwzss/MyArticles/master/iOS%20%E7%A8%8B%E5%BA%8F%E5%91%98%E7%9A%84%20Ruby%20%E5%88%9D%E4%BD%93%E9%AA%8C/2018-02-15%2019_16_29.gif)
   


###æ€»ç»“

 å¯¹äºä¸€é—¨æ–°è¯­è¨€ï¼Œä¸‹æ‰‹å®è·µæ‰æ˜¯çœŸé“ç†ã€‚
 
 å¯¹äºè‡ªå·±ï¼Œå­¦ä¹ è¯­è¨€æœ€å¤§çš„åŠ¨åŠ›è«è¿‡äºä»–èƒ½å¸®åŠ©è‡ªå·±æ›´å¥½çš„ç”Ÿæ´»å’Œå·¥ä½œã€‚

 ä»Šå¤©æ˜¯ 2018 é™¤å¤•ï¼Œç¥å„ä½ç¨‹åºå‘˜åŒèƒæ–°å¹´å¿«ä¹ï¼Œè¿‡å¹´å¤šåƒè‚‰ğŸ˜Šã€‚


###å­¦ä¹ èµ„æ–™
 
1. [rubyåŸºç¡€æ•™ç¨‹ï¼ˆä¸­æ–‡ç¬¬å››ç‰ˆï¼‰](https://www.kancloud.cn/imxieke/ruby-base)
2. [Ruby | èœé¸Ÿæ•™ç¨‹](http://www.runoob.com/ruby/ruby-tutorial.html)
3. [Ruby Chinaç¤¾åŒº](https://ruby-china.org/)
4. [ç°¡å–®ç­†è¨˜ä¸€ä¸‹ RubyGem, Gem, RVM, Gemfile, bundler](http://yulin-learn-web-dev.logdown.com/posts/246089-brief-notes-of-rubygem-gem-rvm-gemfile-bundler)
5. [Mastering ruby blocks in less than 5 minutes](https://mixandgo.com/blog/mastering-ruby-blocks-in-less-than-5-minutes)
6. [åœ¨ Ruby ä¸­æ‰§è¡Œ Shell å‘½ä»¤çš„ 6 ç§æ–¹æ³•](http://www.jishux.com/plus/view-263254-1.html)
7. [å¦‚ä½•å¼€å‘ä¸€ä¸ªè‡ªå·±çš„ Gem](https://ruby-china.org/topics/26292)
8. [How to Use OptionParser: Ruby's Powerful Parsing Tool](https://www.thoughtco.com/optionparser-parsing-command-line-options-2907753)



